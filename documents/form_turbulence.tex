
\subsection{Turbulence closure}\label{sec-tur}


We use the \citet{Umlauf2003} generic length-scale model:
\beqa
  \frac{\D k}{\D t}&=&\frac{\pd }{\pd z}\left( \nu_k^\Psi \frac{\pd k}{\pd z} \right)
  +\nu_t M^2+\nu_t^\theta N^2 -\epsilon \\
  \frac{\D \Psi}{\D t}&=& \frac{\pd }{\pd z}\left( \nu_\Psi \frac{\pd \Psi}{\pd z} \right)
    +\frac{\Psi}{k}(c_{\Psi 1}\nu_tM^2+c_{\Psi 3}\nu_t^\theta N^2-c_{\Psi 2}\epsilon F_{wall})
\eeqa
with natural b.c.:
\beq
   \left\{ \begin{array}{ll}
       \nu_k^\Psi \frac{\pd k}{\pd z} &=0, \mbox{ at } z=-h, \mbox{ or } \eta \\
       \nu_\Psi\frac{\pd \Psi}{\pd z} &= \kappa_0 n\nu_\Psi\frac{\Psi}{l} , \mbox{ at } z=-h \\
       \nu_\Psi\frac{\pd \Psi}{\pd z} &= -\kappa_0 n\nu_\Psi\frac{\Psi}{l} , \mbox{ at } z=\eta \\
           \end{array}
   \right.  \label{tur1}
\eeq
and essential b.c.:
\beq
   \left\{ \begin{array}{ll}
       k&=(c_\mu^0)^{-2} \nu|\frac{\pd \bs{u}}{\pd z}|, \mbox{ at } z=-h, \mbox{ or } \eta\\
       l&=\kappa_0 \D \\
       \Psi &= (c_\mu^0)^pk^m(\kappa_0 \D)^n
           \end{array}
   \right.  \label{tur2}
\eeq
where $k$ is the TKE, $l$ is the mixing length, $c_{\Psi *}$ are some constants and $\Psi=(c_\mu^0)^pk^m l^n$ is a generic length-scale variable.
The turbulence production and dissipation terms are:
\beqa
  M^2&=&\left( \frac{\pd u}{\pd z}\right)^2+\left( \frac{\pd v}{\pd z}\right)^2 \\
  N^2 &=&\frac{g}{\rho_0}\frac{\pd \rho}{\pd z} \\
  \epsilon &=& (c_\mu^0)^3k^{1.5} l^{-1}
\eeqa
In the code, the natural b.c. is applied first (see the FEM formulation below), and the essential b.c. 
 is then used to overwrite the boundary values of the unknown, as suggested by the \gls{gotm} implementation.

GOTM has also been coupled to SELFE, but the native (finite element) implementation is the one used for the Bay-Delta project.
